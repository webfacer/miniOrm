<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>miniOrm</title>
        <meta name="description" content="">
        <link href='http://fonts.googleapis.com/css?family=Rye' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="css/main.css">
        <link href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" rel="stylesheet" type="text/css" />
		<link href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeEclipse.css" rel="stylesheet" type="text/css" />
		<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" type="text/javascript"></script>
		<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushPhp.js" type="text/javascript"></script>
		<script type="text/javascript">
			SyntaxHighlighter.all();
		</script>
    </head>
    <body>
		
		<h1><span>mini</span>Orm</h1>
		
		<h2>Just a mini ORM, for using Object Model &amp; MySQL Abstraction Layer as simply as possible</h2>
		
		<div id="explain">
			<div class="content">
				<div class="block">
					<h3>Simple</h3>
					1 Table = 1 Object Model.<br/>Create, read, update and delete in your database without using any SQL queries.
				</div>
				<div class="block">
					<h3>Light-weight</h3>
					Only one file to include and you're ready.<br/>Don't need to configuration your tables, it automaticlly determine your database model.
				</div>
				<div class="block last">
					<h3>Extensible</h3>
					Extend your object, create easyly relation between it, overdie how to set values, automaticly validate fields &amp; type and size and more...
				</div>
			</div>
		</div>
		
		<div id="page">
			
			<p id="download"><a href="#" class="btn">Download</a></p>
		
			<h4>How to intall ?</h4>
			<p>Just define your database connection, include the miniOrm.php file on you're ready !</p>
	<pre class="brush: php">
	define('_DB_NAME_', 'mini_orm');
	define('_DB_LOGIN_', 'root');
	define('_DB_MDP_', '');
	define('_DB_SERVER_', 'localhost');
	define('_DB_PREFIX_', 'mo_');

	include('miniOrm.php');
	</pre>
	
	<h4>Create, read, update and delete</h4>

	<pre class="brush: php">
    $myCharacter = new Obj('character');
    $myCharacter->name = 'Conan';
    $myCharacter->damage = 10;
    $myCharacter->insert();
    
    $firstCharacter = Obj::load('character', 1);
    $firstCharacter->damage = 12;
	echo 'Character damage : '.$firstCharacter->damage.'<br/>';
    $firstCharacter->update();

    $firstCharacter->delete();
	</pre>
	
	
	<h4>Extend your object</h4>

	<pre class="brush: php">
	class Charcacter extends Obj {
		
		// Can define relation table, load the Race object for the id_race field
		public $relations = array(
			array('table' => 'race', 'field' => 'id_race')
		);
		
		// Shortcut
		public function __construct() {
			return parent::__construct('character');
	    }

	    public static function load($findme) {
			return parent::load('character', $findme);
	    }

		// Extends the set function
		// Call setDamage ( 'set' + 'damage' in camel case) before set in in the object
		public function setDamage($damage) {
			$maxDamage = 0;
			switch ($this->race->name) {
			    case 'Orc':
			        $maxDamage = 10;
			    case 'Human':
			        $maxDamage = 8;
			}
			if($damage > $maxDamage) $damage = $maxDamage;
			return $damage;
		}
		
	}
	
	// Shortcut
	// $myCharacter = new Charcacter();
	$myCharacter = Charcacter::load(array("name = 'Goldorak'"));
	$myCharacter->id_race = 2;
	$myCharacter->refreshRelation();
	// Now you have access to $myCharacter->race as an Obj
	
	// Call before the setDamage function. $myCharacter is an Human, so it damage will be 8
	$myCharacter->damage = 12;
	echo $myCharacter->race->name.' => '.$myCharacter->damage; // Human => 8
	</pre>
	
	
	<h4>MySQL Abstraction Layer</h4>
	
	
	<pre class="brush: php">
	// Db::inst() return an access to your database connection
	$db = Db::inst();
	// Let's create some character (notice, you have to use the table "full name")
	$db->insert('mo_character', array('name' => 'Conan', 'damage' => 12));
	$db->insert('mo_character', array('name' => 'Rahan', 'damage' => 8));
	$db->insert('mo_character', array('name' => 'Toto', 'damage' => 0));
	$db->insert('mo_character', array('name' => 'Goldorak', 'damage' => 19));
	Db::inst()->update('mo_character', array('damage' => 1), array('name="Toto"') );
	// 4 type of select shortcut :
	$characterDamage = $db->getValue('damage', 'mo_character', array('name = "Conan"'));
	// return : 12
    $characterInformations = $db->getRow('*', 'mo_character', array('id_character = 1'));
    // return : Array ( [id_character] => 1 [name] => MrManchot [damage] => 10 ) 
    $twoStrongestCharacters = $db->getArray('name, damage', 'mo_character', 'damage > 5', NULL, 'damage DESC', '0,2');
    // return : Array ( [0] => Array ( [name] => Goldorak [damage] => 19 ) [1] => Array ( [name] => Conan [damage] => 12 ) ) 
    $twoStrongestCharactersIds = $db->getValueArray('id_character', 'mo_character', 'damage > 5');
    // return : Array ( [0] => 1 [1] => 2 [2] => 4 )

	$db->delete('mo_character', array('name="Toto"') );
    $nbCharacters = $db->count('mo_character', array('damage > 10'));
	// Try a wrong query...
	$db->update('mo_character', array('damage' => 1), array('invalid_field="Toto"') );
	$error = $db->error();
	</pre>

	
	<h4>You love it ?</h4>
	
		<!-- AddThis Button BEGIN -->
		<div class="addthis_toolbox addthis_default_style ">
		<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
		<a class="addthis_button_tweet"></a>
		</div>
		<script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
		<script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=mrmanchot"></script>
		<!-- AddThis Button END -->

	<h4>Question ?</h4>
	
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'miniorm'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        
        <h4>Contact : <a href="https://twitter.com/mrmanchot" target="_blank">@MrManchot</a></h4>

        
		</div>
		
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        
        <a href="https://github.com/MrManchot/miniOrm" id="you_fork_my_wife" target="_blank">
			<img src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub">
		</a>

    </body>
</html>
